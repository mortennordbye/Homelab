apiVersion: monitoring.coreos.com/v1alpha1
kind: AlertmanagerConfig
metadata:
  name: discord-alerts
  namespace: kube-prometheus-stack
spec:
  route:
    receiver: discord
    groupBy: ['alertname']
    matchers:
      - name: alertname
        matchType: regexp
        value: "DiskUsageCritical|DiskUsageWarning"
  receivers:
    - name: discord
      discordConfigs:
        - apiURL:
            name: alertmanager-discord-webhook-secret
            key: api-url
          sendResolved: true
