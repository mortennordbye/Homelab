## Minimal kube-prometheus-stack configuration
## Basic monitoring with minimal resource usage

## Prometheus configuration
prometheus:
  prometheusSpec:
    retention: 7d
    storageSpec:
      volumeClaimTemplate:
        spec:
          storageClassName: syno-nfs
          accessModes: ["ReadWriteOnce"]
          resources:
            requests:
              storage: 20Gi
    resources:
      requests:
        cpu: 100m
        memory: 256Mi
      limits:
        memory: 1Gi
    # Scrape interval for minimal load
    scrapeInterval: 30s
    evaluationInterval: 30s

## Grafana configuration
grafana:
  enabled: true

  # Use ExternalSecret for admin credentials
  admin:
    existingSecret: grafana-admin-credentials
    userKey: admin-user
    passwordKey: admin-password

  persistence:
    enabled: true
    storageClassName: syno-nfs
    size: 10Gi

  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits:
      memory: 512Mi

  # Grafana configuration
  grafana.ini:
    server:
      domain: grafana.local.bigd.no

## Disable all scrapers - OTel will handle collection
alertmanager:
  enabled: false

## Enable basic exporters
nodeExporter:
  enabled: true

kubeStateMetrics:
  enabled: true

## Prometheus operator
prometheusOperator:
  resources:
    requests:
      cpu: 50m
      memory: 128Mi
    limits:
      memory: 256Mi

## Minimal monitoring of k8s components
kubeApiServer:
  enabled: false

kubelet:
  enabled: true

kubeControllerManager:
  enabled: false

coreDns:
  enabled: true

kubeEtcd:
  enabled: false

kubeScheduler:
  enabled: false

kubeProxy:
  enabled: true

## Basic alerting rules
defaultRules:
  create: true
  rules:
    alertmanager: false
    etcd: false
    configReloaders: false
    general: true
    k8s: true
    kubeApiserverAvailability: false
    kubeApiserverSlos: false
    kubelet: true
    kubeProxy: false
    kubePrometheusGeneral: true
    kubePrometheusNodeRecording: true
    kubernetesApps: true
    kubernetesResources: true
    kubernetesStorage: true
    kubernetesSystem: true
    kubeScheduler: false
    kubeStateMetrics: true
    network: true
    node: true
    nodeExporterAlerting: true
    nodeExporterRecording: true
    prometheus: true
    prometheusOperator: true
